<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
<properties>
	<comment>话务人员信息查询</comment>
	
    
    <!-- 查询客户信息修改日志 -->
    <entry key="sql-customerModifyReport">
        <![CDATA[
				SELECT	ldi.`after` AS afterModift,
						ldi.`before` AS beforeModift,
						ldi.businessFieldName AS modifyField,
						ld.projectName AS modifierProject,
						ld.gridName AS modifierGrid,
						ld.organizationName AS modifiermanCenter,
						ld.createDate AS modifyTime,
						ld.userName AS modifier,
						ld.customerName as 	customerName
				FROM log_data_modify AS ld,log_data_modify_item AS ldi 
				WHERE ld.id = ldi.id
				{?AND		ld.projectId = #projectId#}
				{?AND		ld.gridId = #gridId#}
				{?AND		ld.organizationId = #organizationId#}
				{?AND		ld.userName  LIKE CONCAT(CONCAT('%',#userName#),'%') ESCAPE '/'}
				{?AND		ld.createDate < #modifyDateEnd#}
				{?AND		ld.createDate > #modifyDateBegin#}
				{?AND		ldi.businessId = #modifyField#}
				{?AND		ld.customerName LIKE CONCAT(CONCAT('%',#customerName#),'%') ESCAPE '/' }
				order by createDate desc
        ]]>
    </entry>


    <!-- 查询客户信息修改日志(数量) -->
    <entry key="sql-customerModifyReport-count">
        <![CDATA[
				SELECT	count(1)

				FROM log_data_modify AS ld,log_data_modify_item AS ldi
				WHERE ld.id = ldi.id
				{?AND		ld.projectId = #projectId#}
				{?AND		ld.gridId = #gridId#}
				{?AND		ld.organizationId = #organizationId#}
				{?AND		ld.userName  LIKE CONCAT(CONCAT('%',#userName#),'%') ESCAPE '/'}
				{?AND		ld.createDate < #modifyDateEnd#}
				{?AND		ld.createDate > #modifyDateBegin#}
				{?AND		ldi.businessId = #modifyField#}
				{?AND		ld.customerName LIKE CONCAT(CONCAT('%',#customerName#),'%') ESCAPE '/' }
        ]]>
    </entry>

    <!-- 查询房客关系修改日志 -->
    <entry key="sql-relationChangeReport">
        <![CDATA[
			SELECT 
				houseId,
				houseName,
				customerId,
				customerName,
				(case
                when relationid = '1' then '拥有'
                when relationid = '2' then '居住'
                when relationid = '3' then '租赁'
                when relationid = '4' then '账单'
                when relationid = '5' then '分润'
                when relationid = '98' then '其他'
                end)  as relationText,
				createDate,
				userName,
				changeType,
				projectName,
				gridName,
				organizationName 
			FROM 
				log_relation_change
			WHERE
				1 = 1
				and resourceName  = '房屋'
				{?AND	projectId = #projectId#}
				{?AND	gridId = #gridId#}
				{?AND	organizationId = #organizationId#}
				{?AND	userName LIKE CONCAT(CONCAT('%',#userName#),'%') ESCAPE '/' }
				{?AND	createDate < #modifyDateEnd#}
				{?AND	createDate > #modifyDateBegin#}
				{?AND	changeType = #changeType#}
				order by createDate desc
        ]]>
    </entry>



    <!-- 查询房客关系修改日志(条数) -->
    <entry key="sql-relationChangeReport-count">
        <![CDATA[
			SELECT
			count(1)
			FROM
				log_relation_change
			WHERE
				1 = 1
				and resourceName  = '房屋'
				{?AND	projectId = #projectId#}
				{?AND	gridId = #gridId#}
				{?AND	organizationId = #organizationId#}
				{?AND	userName = #userName#}
				{?AND	createDate < #modifyDateEnd#}
				{?AND	createDate > #modifyDateBegin#}
				{?AND	changeType = #changeType#}
				order by createDate desc
        ]]>
    </entry>


    <!-- 获取修改选项 -->
    <entry key="sql-modifyitem">
        <![CDATA[
			 select DISTINCT(businessId) as code,businessFieldName  as value from log_data_modify_item
        ]]>
    </entry>


</properties>