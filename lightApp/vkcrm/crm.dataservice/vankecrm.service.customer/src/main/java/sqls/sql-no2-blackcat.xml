<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
<properties>
	<comment>黑猫2号接口sql</comment>



	<!-- 项目客房关系信息(黑猫2号项目需要) -->
	<entry key="sql.query.no2.projectcustomerhouserelation">
        <![CDATA[
		select  
			p.name projectName,
			h.buildingCode, 
			h.buildingName, 
			h.unit,
			i.value relation,
			h.code houseCode , 
			h.name houseName, 
			m.relationType, 
			c.code customerCode,
			c.fullName, 
			c.mainMobile,
			c.standbyMobile,
			c.homeTel,
			c.officeTel,
			c.certificateId ,
			c.certificateType ,
			m.isDeleted isDelete
		from main_project p 
	  	join main_house h on p.id =h.projectId
		join mid_customer_house m on h.id = m.houseId 
		join main_customer c on c.id = m.customerId
		join (select value,code from dim_dictionary_items  where dictionaryId =(SELECT id from dim_dictionary where tableName = 'mid_customer_house')) i on i.code = m.relationType
		where 1=1 
		{? AND p.code= #projectCode# } 
		{? AND c.code =#customerCode# } 
		{? AND (h.modifyTime>=#updateTime# or m.createTime >#updateTime# or c.modifyTime >#updateTime#)}
        ]]>
	</entry>
	
	<!-- 通过客户编码获取其联系信息 -->
    <entry key="sql.query.customer.contact">
        <![CDATA[
		select CODE AS customerCode,fullName,mainMobile,standbyMobile,homeTel,officeTel 
		from main_customer  
		{? where code =#customerCode#}
		limit 0,1
        ]]>
    </entry>
    




</properties>
