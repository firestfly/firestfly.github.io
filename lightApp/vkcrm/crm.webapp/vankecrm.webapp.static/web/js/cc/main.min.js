require.config({baseUrl:"./",paths:{mmRouter:"static/js/avalon/mmRouter",text:"static/require/text",domReady:"static/require/domReady",css:"static/require/css.js",clock:"static/js/plugs/clock/clock.js",validate:"static/js/plugs/validate/validate.js",datepicker:"static/js/plugs/My97DatePicker/WdatePicker.js",widget_businessType:"static/js/plugs/businesstype/widget.js"},priority:["text","css"],shim:{datepicker:{exports:"datepicker"},jquery:{exports:"jQuery"},avalon:{exports:"avalon"}}}),function(){var a={number:/[^\d]/g,mobile:/[^\d#\*]/g,name:/[^a-z|\u4e00-\u9fa5]/g,content:/[^a-z|A-Z|0-9|\u4e00-\u9fa5|\uFF0C\u3002\uFF1F\uFF01\u201C\u201D\uFF08\uFF09\uFF1B\u300A\u300B\u0025\u3001|+-:@|\u0020\u000A]/g};avalon.duplexHooks.mobile={set:function(b,c){return b?(b+"").replace(a.mobile,""):""}},avalon.duplexHooks.name={set:function(b,c){return b?(b+"").replace(a.name,""):void 0}},avalon.duplexHooks.digit={set:function(b,c){return b?(b+"").replace(a.number,""):""}},avalon.duplexHooks.content={set:function(b){return b?(b+"").replace(a.content,""):""}},avalon.filters.appTaskStatus=function(a){return Config.objs.AppTaskStatus[a]||""},avalon.filters.taskLevelType=function(a){return Config.objs.TaskLevelType[a]||""},avalon.filters.taskSource=function(a){return Config.objs.TaskSource[a]||""},avalon.filters.taskAbnormalStatus=function(a){return"1"==a?"无类型":"2"==a?"超时未处理":void 0},avalon.filters.taskCompleteStatus=function(a){return"0"==a?"未完成":"1"==a?"已完成":void 0}}(),require(["domReady!","mmRouter"],function(){function a(a,b,c,d){require(["text!views/"+b+"/index.html","views/"+b+"/index"],function(e,f){avalon.templateCache[b]=e,avalon.vmodels[a]["src_"+b]=b,avalon.vmodels[a].visibleIndex=b,setTimeout(function(){f.active&&f.active(c),d&&d()})})}function b(){var b=this.params.module,c=this.params.submodule,d=this.params.thirdmodule,e=this.query;b||(b="contenttask",c="taskinput"),a("root",b,e,function(){c&&a(b,c,e,function(){d&&a(c,e,d)})})}function c(){j&&j.abort(),j=Common.ajax({url:servicePath.task+"/v1/callcenter/task/allAbnormalTask",type:"GET",success:function(a){a&&(i.abnormal.count=a[0]+" / "+a[1])},error:function(){},complete:function(){}}),setTimeout(c,Config.abnormalTask.interval)}function d(){var a=["AppTaskStatus","ProcessingWay","TaskSource","TaskLevelType","Duty","FinishType"].join(",");return Common.ajax({url:servicePath.task+"/v1/dict/items",type:"POST",data:{codes:a},success:function(a){Config.keys.TaskSource=a.TaskSource,Config.keys.TaskLevelType=a.TaskLevelType,Config.keys.ProcessingWay=a.ProcessingWay,Config.keys.Duty=a.Duty,Config.keys.FinishType=a.FinishType;for(var b,c=Config.objs.AppTaskStatus={},d=Config.objs.TaskSource={},e=Config.objs.TaskLevelType={},f=Config.objs.ProcessingWay={},g=0;g<a.ProcessingWay.length;g++)b=a.ProcessingWay[g],f[b.code]=b.value;for(var g=0;g<a.AppTaskStatus.length;g++)b=a.AppTaskStatus[g],c[b.code]=b.value;for(var g=0;g<a.TaskSource.length;g++)b=a.TaskSource[g],d[b.code]=b.value;for(var g=0;g<a.TaskLevelType.length;g++)b=a.TaskLevelType[g],e[b.code]=b.value},error:function(){},complete:function(){}})}function e(){var a=["CustomerSex","CustomerRelationType","HouseCustomerRelationType","CustomerHobbies","CustomerIdentity"].join(",");return Common.ajax({url:servicePath.customer+"/v1/dict/items",type:"POST",data:{codes:a},success:function(a){for(var b in a)Config.keys[b]=a[b]},error:function(){},complete:function(){}})}function f(){return Common.ajax({url:servicePath.tel+"/v1/telrecord/callreason/get",type:"GET",data:{type:0},success:function(a){if(a){for(var b=a,c=[],d=[],e=0;e<b.length;e++)1==b[e].type?c.push(b[e]):2==b[e].type&&d.push(b[e]);Config.callReason={callin:c,callout:d}}},error:function(){},complete:function(){}})}function g(){return Common.ajax({url:servicePath.task+"/v1/callcenter/task/businesstype",type:"GET",success:function(a){for(var b,c,d={},e=[],f=0;f<a.length;f++)b=a[f],b.children=[],d[b.businessCode]=b,c=d[b.parentCode],c?c.children.push(b):e.push(b);Config.businessType={list:e,obj:d}},error:function(){},complete:function(){}})}function h(){return Common.ajax({url:servicePath.task+"/v1/callcenter/task/getTaskSatisfaction",type:"GET",success:function(a){if(a){for(var b,c={},d=[],e=0;e<a.length;e++)b=a[e],c[b.code]=b,b.parentCode?c[b.parentCode]&&(c[b.parentCode].children||(c[b.parentCode].children=[]),c[b.parentCode].children.push(b)):d.push(b);Config.evaluation={list:d,obj:c}}},error:function(){},complete:function(){}})}avalon.templateCache.empty=" ";var i=avalon.define({$id:"root",callctrl_rendered:function(){require(["views/callctrl/index"],function(a){a.active()})},visibleIndex:"",src_contenttask:"",src_contentreport:"",src_contentnotice:"",src_contentsystem:"",src_contentnewtask:"",abnormal:{count:""},contentGo:function(a){i.visibleIndex=a},headerboxVisible:!1,headerboxToggle:function(){i.headerboxVisible=!i.headerboxVisible},eventAbnormalTask:function(){if(i.abnormal.count){Common.tip.add(Config.tips.gettingAbnormalTask);Common.ajax({url:servicePath.task+"/v1/callcenter/task/allotAbnormalTask",type:"GET",success:function(a){a&&(avalon.router.redirect("/contenttask/taskquery?id="+a.taskNo+"&abtype="+a.res.abnormal_type+"&islocal=false"),Common.tip.add({text:Config.tips.getAbnormalTaskSuccess,type:"success"}),Common.log("getTask",{taskNo:a.taskNo}))},error:function(){Common.tip.add({text:Config.tips.getAbnormalTaskError,type:"error"})},complete:function(){}})}}}),j=null;$.when(d(),e(),f(),g(),h()).fail(function(){alert("加载失败")}).done(function(){avalon.scan(document.body),$("#basecover").remove(),avalon.router.get("/",b),avalon.router.get("/:module",b),avalon.router.get("/:module/:submodule",b),avalon.router.get("/:module/:submodule/:thirdmodule",b),avalon.history.start({html5Mode:!1}),avalon.history.stop(),c()})});